# 13.罗马数字转整数

题目链接：[13.罗马数字转整数](https://leetcode.cn/problems/roman-to-integer/)

## 题目大意

罗马数字包含以下七种字符: `I`，`V`，`X`，`L`，`C`，`D` 和 `M`

```js
字符          数值
I             1
V             5
X             10
L             50
C             100
D             500
M             1000
```
例如， 罗马数字 `2` 写做 `II`，即为两个并列的 `1`，`12` 写做 `XII`，即为 `X + II`，`27` 写做 `XXVII`, 即为 `XX + V + II`

通常情况下，罗马数字中小的数字在大的数字的右边。但也存在特例，例如 `4` 不写做 `IIII`，而是 `IV`。数字 `1` 在数字 `5` 的左边，所表示的数等于大数 `5` 减小数 `1` 得到的数值 `4`。同样地，数字 `9` 表示为 `IX`。这个特殊的规则只适用于以下六种情况：
- `I` 可以放在 `V(5)` 和 `X(10)` 的左边，来表示 `4` 和 `9`
- `X` 可以放在 `L(50)` 和 `C(100)` 的左边，来表示 `40` 和 `90`
- `C` 可以放在 `D(500)` 和 `M(1000)` 的左边，来表示 `400` 和 `900`

给定一个罗马数字，将其转换成整数

```js
Example 1:
Input: s = "III"
Output: 3
Explanation: III = 3.

Example 2:
Input: s = "LVIII"
Output: 58
Explanation: L = 50, V= 5, III = 3.

Example 3:
Input: s = "MCMXCIV"
Output: 1994
Explanation: M = 1000, CM = 900, XC = 90 and IV = 4.
```

限制：
- 1 <= s.length <= 15
- s contains only the characters ('I', 'V', 'X', 'L', 'C', 'D', 'M').
- It is guaranteed that s is a valid roman numeral in the range [1, 3999].

## 解题

罗马数字规则规定：**如果一个较小的数值出现在一个较大的数值的左边，就要用减法（如 IV 表示 4），在其他情况下做加法**

我们遍历时需判断：
- 当前字符的值 `values[s[i]]` 和下一个字符的值 `values[s[i+1]]`
- 如果`当前值 < 下一个值`，说明遇到了特殊情况，应`减去`当前值
- 否则正常`加上`当前值
- 最后得到的总和就是转换结果

这样就不需要特意处理 `6` 种特殊组合，统一在遍历时判断

这是一个`线性扫描 + 局部决策`的算法


```js
var romanToInt = function(s) {
    const values = {
        'I': 1, 
        'V': 5, 
        'X': 10, 
        'L': 50, 
        'C': 100, 
        'D': 500, 
        'M': 1000
    };
    let total = 0, n = s.length;
    for (let i = 0; i < n; i++) {
        // 如果不是最后一个字符，且当前字符比下一个字符小，则做减法
        if (i + 1 < n && values[s[i]] < values[s[i + 1]]) {
            total -= values[s[i]];
        } else {
            total += values[s[i]];
        }
    }

    return total;
};
```
```python
class Solution:
    def romanToInt(self, s: str) -> int:
        # 创建一个字典 values，把每个罗马字符映射到对应的整数
        values = {
            'I': 1, 
            'V': 5, 
            'X': 10, 
            'L': 50, 
            'C': 100, 
            'D': 500, 
            'M': 1000
        }
        # 初始化 total，用来累计最终结果
        total = 0
        # n 保存输入字符串的长度，方便后面判断索引边界
        n = len(s)
        # 使用 for 循环，遍历字符串 s 的每一个字符索引 i，从 0 到 n-1
        for i in range(n):  
            # 判断是否满足特殊减法条件：
            # - i + 1 < n 确保有下一个字符可以比较（不越界）
            # - values[s[i]] < values[s[i+1]] 当前值小于下一个值，说明是特殊组合，应该用减法
            if i + 1 < n and values[s[i]] < values[s[i+1]]:
                total -= values[s[i]]
            else:
                total += values[s[i]]
        
        return total
```

- 时间复杂度：`O(n)`，其中 `n` 是字符串 `s` 的长度
- 空间复杂度：`O(1)`